@{
    Layout = null;
    var type = Request.QueryString["type"];
}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Layer Editor</title>
</head>
    <body>
        @if (type == "text" || type=="header")
        {
            <p><textarea class="editor" id="Text" name="Text"></textarea></p>
        }
        else if(type == "image")
        {
            <p><input class="editor" type="text" id="ImageUrl" name="ImageUrl" placeholder="Image Url" /></p>
        }
        else if (type == "iframe")
        {
            <p>Link</p>
            <p><input class="editor" type="text" id="IFrameUrl" name="IFrameUrl" placeholder="IFrame Url" /></p>
            <p>Embed</p>
            <p><textarea class="editor" id="IFrameEmbed" style="margin: 2px; width: 460px; height: 180px;" name="Text"></textarea></p>
        }
        <p>
            <input id="btnClose" type="button" value="Accept" onclick="AcceptDialog();" />
            <input id="btnClose" type="button" value="Ok" onclick="OkDialog();" />
            <input id="btnClose" type="button" value="Cancel" onclick="CloseDialog();" />
        </p>


        
        @Scripts.Render("~/bundles/jquery")
        <script src="//cdn.ckeditor.com/4.4.5/full/ckeditor.js"></script>
        <script src="@Url.Content("~/Scripts/parllaxJS.js")"></script>
        <script type="text/javascript">
            //init
            var type = '@type';
            $('.editor').val(window.objValue);
            if (type == "image" && window.objValue != undefined && window.objValue!="") {
                alert(window.objValue);
                showImage(window.objValue);
            }
            if (type == objPLayer.Type.Text || type == objPLayer.Type.Header) {
                var ckeditor = CKEDITOR.replace('Text', {
                    toolbar: [
                        { name: 'document', items: ['Source'] },	// Defines toolbar group with name (used to create voice label) and items in 3 subgroups.
                        ['Undo', 'Redo'], // Defines toolbar group without name.
                        { name: 'basicstyles', groups: ['basicstyles', 'cleanup'], items: ['Bold', 'Italic', 'Underline'] },
                        { name: 'paragraph', items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight'] },
                        "/",
                        { name: 'styles', items: ['Format', 'Font', 'FontSize'] },
                        { name: 'colors', items: ['TextColor', 'BGColor'] }
                    ]
                });
            }

            function OkDialog() {
                AcceptDialog();
                CloseDialog();
            }

            function AcceptDialog() {
                var value = "";
                if (type == objPLayer.Type.Text||type==objPLayer.Type.Header)
                    value = ckeditor.getData();
                if (type == objPLayer.Type.Image) {
                    value = $('#ImageUrl').val();
                    var pic = $('img');
                    pic.removeAttr("style");
                    //var css = { width: pic.width(), height: pic.height() };
                    var css = { width: pic.width(), height: pic.height() };
                    value = '<img src="' + value + '" style="width:100%; height:100%;" />';
                }
                if (type == objPLayer.Type.Iframe) {
                    if ($('#IFrameUrl').val() != "") {
                        value = '<iframe src="' + $('#IFrameUrl').val() + '" frameborder="0" style="width:100%; height:100%;"></iframe>';
                    } else {
                        value = $('#IFrameEmbed').val();
                        value = $(value).removeAttr("style");
                    }
                    var css = { width: $(value).attr("width"), height: $(value).attr("height") };
                    css.width = (css.width == undefined || css.width == 0) ? 640 : css.width;
                    css.height = (css.height == undefined || css.height == 0) ? 480 : css.height;
                    value = $(value).attr("width", "100%");
                    value = $(value).attr("height", "100%");
                    
                }
                window.opener.setLayerValue(type, value, css);
   
                
            }
            function CloseDialog() {
                window.close();
            }

            $(document).ready(function () {
                $('#ImageUrl').blur(function () {
                    if ($(this).val() != "")
                        showImage($(this).val());
                });
            });

            function showImage(url) {
                $($('#ImageUrl')).parent().find('img').remove();
                $('#ImageUrl').after("<img src ='" + url + "' style='max-width:100px' />");
            }
            
        </script>
    </body>

</html>


